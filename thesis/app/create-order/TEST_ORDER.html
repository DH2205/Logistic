<!DOCTYPE html>
<html>
<head>
    <title>Test Order Creation</title>
</head>
<body>
    <h1>Test Order Creation API</h1>
    
    <button onclick="testGenerateId()">1. Test Generate Order ID</button>
    <button onclick="testCreateOrder()">2. Test Create Order</button>
    
    <h2>Results:</h2>
    <pre id="results"></pre>
    
    <script>
        function log(message) {
            const results = document.getElementById('results');
            results.textContent += message + '\n\n';
            console.log(message);
        }
        
        async function testGenerateId() {
            log('Testing Order ID Generation...');
            try {
                const response = await fetch('http://localhost:3000/api/orders/generate-id');
                const data = await response.json();
                log('✅ Order ID Generated: ' + JSON.stringify(data, null, 2));
            } catch (error) {
                log('❌ Error: ' + error.message);
            }
        }
        
        async function testCreateOrder() {
            log('Testing Order Creation...');
            
            // Get token from localStorage
            const token = localStorage.getItem('token');
            if (!token) {
                log('❌ No token found! Please login first at http://localhost:3000/login');
                return;
            }
            
            const orderData = {
                orderId: 'ORD-TEST-2026',
                userId: 'test-user-id',
                senderName: 'Test Sender',
                senderPhone: '+1234567890',
                senderEmail: 'sender@test.com',
                senderAddress: '123 Test St',
                receiverName: 'Test Receiver',
                receiverAddress: '456 Test Ave',
                length: 30,
                width: 20,
                height: 15,
                weight: 5.5,
                grossWeight: 6.0,
                fromLocation: 'Test City A',
                toLocation: 'Test City B',
                status: 'pending',
                createdAt: new Date().toISOString()
            };
            
            log('Sending order data: ' + JSON.stringify(orderData, null, 2));
            
            try {
                const response = await fetch('http://localhost:3000/api/orders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(orderData)
                });
                
                log('Response Status: ' + response.status + ' ' + response.statusText);
                
                const result = await response.json();
                
                if (response.ok) {
                    log('✅ Order Created Successfully!');
                    log('Result: ' + JSON.stringify(result, null, 2));
                } else {
                    log('❌ Order Creation Failed!');
                    log('Error: ' + JSON.stringify(result, null, 2));
                }
            } catch (error) {
                log('❌ Network Error: ' + error.message);
            }
        }
    </script>
</body>
</html>
